[fortran, fortran_omptarget]

    integer :: k
    real(C_DOUBLE) :: z

	!$omp target teams distribute parallel do simd depend(inout:asyncid) nowait
	do k = 1 , nz
	  z = (k_beg-1 + k-0.5_rp)*dz
	  if (abs(z-3*zlen/4) <= zlen/16) then
		state(-1:0,k,ID_UMOM) = (state(-1:0,k,ID_DENS)+hy_dens_cell(k)) * 50._rp
		state(-1:0,k,ID_RHOT) = (state(-1:0,k,ID_DENS)+hy_dens_cell(k)) * 298._rp - hy_dens_theta_cell(k)
	  endif
	enddo
