[fortran]

	integer ll, k, i

    do ll = 1 , NUM_VARS
      do k = 1 , nz
        do i = 1 , nx
          stateout(i,k,ll) = stateinit(i,k,ll) + dt * tend(i,k,ll)
        enddo
      enddo
    enddo

[fortran_openacc]

	integer ll, k, i

	!$acc parallel loop collapse(3) present(stateout, stateinit, tend)
    do ll = 1 , NUM_VARS
      do k = 1 , nz
        do i = 1 , nx
          stateout(i,k,ll) = stateinit(i,k,ll) + dt * tend(i,k,ll)
        enddo
      enddo
    enddo

